<Window x:Class="PadelSimple.Desktop.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:PadelSimple.Desktop.ViewModels"
        xmlns:conv="clr-namespace:PadelSimple.Desktop.Converters"
        Title="PadelSimple"
        Height="600" Width="900">

    <!-- GEEN Window.DataContext meer, DI zet dat in code-behind -->

    <Window.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibility" />
    </Window.Resources>

    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_Bestand">
                <!-- 🔹 Afmelden vanuit Main -->
                <MenuItem Header="Afmelden" Command="{Binding LogoutCommand}"/>
                <Separator/>
                <MenuItem Header="Sluiten" Click="Exit_Click"/>
            </MenuItem>
        </Menu>

        <TabControl>
            <!-- Reservaties / overzicht -->
            <TabItem Header="Overzicht">
                <!-- 🔹 Overzicht ingevuld: datum + reservaties + nieuwe reservatie -->
                <DockPanel Margin="10">
                    <!-- Bovenbalk: datum + knoppen -->
                    <StackPanel DockPanel.Dock="Top"
                                Orientation="Horizontal"
                                Margin="0,0,0,10">
                        <TextBlock Text="Datum:"
                                   VerticalAlignment="Center"
                                   Margin="0,0,5,0"/>
                        <DatePicker SelectedDate="{Binding SelectedDate}"
                                    Width="140"
                                    Margin="0,0,10,0"/>

                        <Button Content="Laad reservaties"
                                Command="{Binding LoadReservationsCommand}"
                                Margin="0,0,10,0"/>

                        <Button Content="Nieuwe reservatie"
                                Command="{Binding NewReservationCommand}"/>
                    </StackPanel>

                    <!-- Lijst met reservaties -->
                    <DataGrid ItemsSource="{Binding Reservations}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Datum"
                                                Binding="{Binding Date, StringFormat='{}{0:dd/MM/yyyy}'}"/>
                            <DataGridTextColumn Header="Start"
                                                Binding="{Binding StartTime}"/>
                            <DataGridTextColumn Header="Einde"
                                                Binding="{Binding EndTime}"/>
                            <DataGridTextColumn Header="Terrein"
                                                Binding="{Binding Court.Name}"/>
                            <DataGridTextColumn Header="Spelers"
                                                Binding="{Binding NumberOfPlayers}"/>
                            <DataGridTextColumn Header="Materiaal"
                                                Binding="{Binding Equipment.Name}"/>
                            <DataGridTextColumn Header="Aantal"
                                                Binding="{Binding EquipmentQuantity}"/>
                            <DataGridTextColumn Header="Gebruiker"
                                                Binding="{Binding User.Email}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>

            <!-- Admin -->
            <TabItem Header="Beheer" Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVisibility}}">
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Courts -->
                    <GroupBox Header="Terreinen" Margin="5">
                        <DockPanel>
                            <ToolBar DockPanel.Dock="Top">
                                <Button Content="Nieuw" Command="{Binding NewCourtCommand}"/>
                                <Button Content="Opslaan" Command="{Binding SaveCourtCommand}"/>
                            </ToolBar>
                            <DataGrid ItemsSource="{Binding Courts}"
          SelectedItem="{Binding SelectedCourt}"
          AutoGenerateColumns="False"
          Margin="0,5,0,0"
          IsSynchronizedWithCurrentItem="True"
          SelectionUnit="FullRow"
          RowEditEnding="DataGrid_RowEditEnding">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Naam" Binding="{Binding Name}"/>
                                    <DataGridTextColumn Header="Capaciteit" Binding="{Binding Capacity}"/>
                                    <DataGridCheckBoxColumn Header="Indoor" Binding="{Binding IsIndoor}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </DockPanel>
                    </GroupBox>

                    <!-- Materiaal -->
                    <GroupBox Header="Materiaal" Margin="5" Grid.Column="1">
                        <DockPanel>
                            <ToolBar DockPanel.Dock="Top">
                                <Button Content="Nieuw" Command="{Binding NewEquipmentCommand}"/>
                                <Button Content="Opslaan" Command="{Binding SaveEquipmentCommand}"/>
                            </ToolBar>
                            <DataGrid ItemsSource="{Binding EquipmentList}"
          SelectedItem="{Binding SelectedEquipment}"
          AutoGenerateColumns="False"
          Margin="0,5,0,0"
          IsSynchronizedWithCurrentItem="True"
          SelectionUnit="FullRow"
          RowEditEnding="DataGrid_RowEditEnding">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Naam" Binding="{Binding Name}"/>
                                    <DataGridTextColumn Header="Totaal" Binding="{Binding TotalQuantity}"/>
                                    <DataGridTextColumn Header="Beschikbaar" Binding="{Binding AvailableQuantity}"/>
                                    <DataGridCheckBoxColumn Header="Actief" Binding="{Binding IsActive}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </DockPanel>
                    </GroupBox>

                    <!-- Gebruikers -->
                    <GroupBox Header="Gebruikers" Margin="5" Grid.Column="2">
                        <DockPanel>
                            <DataGrid ItemsSource="{Binding Users}"
                                      SelectedItem="{Binding SelectedUser}"
                                      AutoGenerateColumns="False"
                                      Margin="0,0,0,5">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Email" Binding="{Binding Email}"/>
                                    <DataGridCheckBoxColumn Header="Lid" Binding="{Binding IsMember}"/>
                                    <DataGridCheckBoxColumn Header="Geblokkeerd" Binding="{Binding IsBlocked}"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <StackPanel Orientation="Vertical" DockPanel.Dock="Bottom">
                                <Button Content="Maak Admin"
                                        Command="{Binding MakeAdminCommand}"
                                        Margin="0,2,0,0"/>
                                <Button Content="Verwijder Admin"
                                        Command="{Binding RemoveAdminCommand}"
                                        Margin="0,2,0,0"/>
                                <Button Content="Blokkeer"
                                        Command="{Binding BlockUserCommand}"
                                        Margin="0,2,0,0"/>
                                <Button Content="Deblokkeer"
                                        Command="{Binding UnblockUserCommand}"
                                        Margin="0,2,0,0"/>
                            </StackPanel>
                        </DockPanel>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
